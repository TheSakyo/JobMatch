<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des donn√©es - JobMatch+</title>
    <link rel="stylesheet" href="../styles/styles.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo">
            <img src="../images/logo.png" alt="JobMatch Logo">
        </div>
        <nav>
            <ul>
                <li><a href="../index.html">Accueil</a></li>
                <li><a href="profile.html">Mon profil</a></li>
                <li><a href="privacy.html">Confidentialit√©</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main class="data-management">
        <h1>üîê Gestion de mes donn√©es personnelles</h1>
        
        <div class="info-card">
            <p><strong>Conform√©ment au RGPD</strong>, vous disposez de droits sur vos donn√©es personnelles. 
            Cette page vous permet d'exercer ces droits simplement et en toute s√©curit√©.</p>
        </div>

        <!-- R√©sum√© des donn√©es -->
        <div class="data-section">
            <h2>üìä R√©sum√© de mes donn√©es</h2>
            <div class="data-summary">
                <p><strong>Compte cr√©√© le :</strong> <span id="account-date">01/10/2025</span></p>
                <p><strong>Derni√®re connexion :</strong> <span id="last-login">07/10/2025</span></p>
                <p><strong>Type de compte :</strong> <span id="account-type">Candidat</span></p>
                <p><strong>Donn√©es stock√©es :</strong></p>
                <ul>
                    <li>‚úÖ Informations de profil (nom, email)</li>
                    <li>‚úÖ CV et exp√©riences professionnelles</li>
                    <li>‚úÖ Pr√©f√©rences de recherche</li>
                    <li>‚úÖ Historique des candidatures</li>
                    <li id="newsletter-status">‚ùå Newsletter (non abonn√©)</li>
                </ul>
            </div>
        </div>

        <!-- Droit d'acc√®s -->
        <div class="data-section">
            <h2>üìã Droit d'acc√®s √† mes donn√©es</h2>
            <p>Obtenez une copie compl√®te de toutes vos donn√©es personnelles que nous d√©tenons.</p>
            <div class="action-buttons">
                <button class="btn-action btn-primary" onclick="requestDataExport()">
                    üì• T√©l√©charger mes donn√©es
                </button>
                <button class="btn-action btn-secondary" onclick="showDataDetails()">
                    üëÅÔ∏è Voir le d√©tail de mes donn√©es
                </button>
            </div>
            <div class="info-card">
                <p><strong>D√©lai :</strong> Vous recevrez vos donn√©es par email sous 30 jours maximum (g√©n√©ralement sous 48h).</p>
            </div>
        </div>

        <!-- Droit de rectification -->
        <div class="data-section">
            <h2>‚úèÔ∏è Droit de rectification</h2>
            <p>Corrigez ou mettez √† jour vos informations personnelles.</p>
            <div class="action-buttons">
                <a href="profile.html" class="btn-action btn-primary">
                    ‚úèÔ∏è Modifier mon profil
                </a>
                <button class="btn-action btn-secondary" onclick="requestCorrection()">
                    üìù Signaler une erreur
                </button>
            </div>
        </div>

        <!-- Droit √† la portabilit√© -->
        <div class="data-section">
            <h2>üì¶ Droit √† la portabilit√©</h2>
            <p>R√©cup√©rez vos donn√©es dans un format structur√© pour les transf√©rer vers un autre service.</p>
            <div class="action-buttons">
                <button class="btn-action btn-primary" onclick="requestPortability('json')">
                    üìÑ Format JSON
                </button>
                <button class="btn-action btn-primary" onclick="requestPortability('csv')">
                    üìä Format CSV
                </button>
                <button class="btn-action btn-primary" onclick="requestPortability('pdf')">
                    üìã Format PDF
                </button>
            </div>
        </div>

        <!-- Droit d'opposition -->
        <div class="data-section">
            <h2>üö´ Droit d'opposition</h2>
            <p>Vous opposez √† certains traitements de vos donn√©es personnelles.</p>
            <div class="action-buttons">
                <button class="btn-action btn-warning" onclick="manageConsents()">
                    ‚öôÔ∏è G√©rer mes consentements
                </button>
                <button class="btn-action btn-warning" onclick="optOutMarketing()">
                    üìß Me d√©sinscrire des emails marketing
                </button>
                <button class="btn-action btn-warning" onclick="limitProcessing()">
                    ‚è∏Ô∏è Limiter le traitement de mes donn√©es
                </button>
            </div>
        </div>

        <!-- Droit √† l'effacement -->
        <div class="data-section">
            <h2>üóëÔ∏è Droit √† l'effacement ("droit √† l'oubli")</h2>
            <div class="warning-card">
                <p><strong>‚ö†Ô∏è Attention :</strong> Cette action est irr√©versible. Toutes vos donn√©es seront d√©finitivement supprim√©es.</p>
            </div>
            <p>Supprimez d√©finitivement votre compte et toutes vos donn√©es personnelles.</p>
            <div class="action-buttons">
                <button class="btn-action btn-secondary" onclick="requestAccountDeactivation()">
                    ‚è∏Ô∏è D√©sactiver temporairement mon compte
                </button>
                <button class="btn-action btn-danger" onclick="requestAccountDeletion()">
                    üóëÔ∏è Supprimer d√©finitivement mon compte
                </button>
            </div>
            <div class="info-card">
                <p><strong>Exceptions :</strong> Certaines donn√©es peuvent √™tre conserv√©es pour des obligations l√©gales 
                (facturation : 10 ans, contentieux en cours, etc.).</p>
            </div>
        </div>

        <!-- Contact responsable -->
        <div class="contact-responsable">
            <h2>üîê Contactez notre D√©l√©gu√© √† la Protection des Donn√©es</h2>
            <p>Pour toute question ou demande sp√©cifique concernant vos donn√©es personnelles :</p>
            <div class="action-buttons" style="justify-content: center;">
                <a href="mailto:responsable@jobmatch.fr" class="btn-action btn-primary">
                    üìß responsable@jobmatch.fr
                </a>
                <button class="btn-action btn-secondary" onclick="openContactForm()">
                    üìù Formulaire de contact
                </button>
            </div>
            <p><small>D√©lai de r√©ponse : 30 jours maximum (g√©n√©ralement sous 5 jours ouvr√©s)</small></p>
        </div>

        <!-- Information CNIL -->
        <div class="info-card">
            <h3>üìû R√©clamations</h3>
            <p>Si vous estimez que vos droits ne sont pas respect√©s, vous pouvez :</p>
            <ul>
                <li>Nous contacter directement : <a href="mailto:responsable@jobmatch.fr">responsable@jobmatch.fr</a></li>
                <li>Saisir la CNIL : <a href="https://www.cnil.fr/fr/plaintes" target="_blank">www.cnil.fr/fr/plaintes</a></li>
            </ul>
        </div>
    </main>

    <!-- Modal de contact -->
    <div id="contactModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeContactModal()">&times;</span>
            <h2>üìù Contacter le responsable</h2>
            <form id="responsableContactForm">
                <div class="form-group">
                    <label for="request-type">Type de demande :</label>
                    <select id="request-type" name="request-type" required>
                        <option value="">S√©lectionnez</option>
                        <option value="access">Droit d'acc√®s</option>
                        <option value="rectification">Droit de rectification</option>
                        <option value="erasure">Droit √† l'effacement</option>
                        <option value="portability">Droit √† la portabilit√©</option>
                        <option value="opposition">Droit d'opposition</option>
                        <option value="complaint">R√©clamation</option>
                        <option value="other">Autre</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="message">Message :</label>
                    <textarea id="message" name="message" placeholder="D√©crivez votre demande..." required></textarea>
                </div>
                <div class="action-buttons">
                    <button type="submit" class="btn-action btn-primary">üì§ Envoyer</button>
                    <button type="button" class="btn-action btn-secondary" onclick="closeContactModal()">‚ùå Annuler</button>
                </div>
            </form>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 JobMatch+. Tous droits r√©serv√©s.</p>
        <div class="footer-links">
            <a href="legal.html">Mentions l√©gales</a>
            <a href="privacy.html">Politique de confidentialit√©</a>
            <a href="contact.html">Contact</a>
        </div>
    </footer>

    <script src="../js/script.js"></script>
    <script src="../js/loadCookies.js"></script>
    <script>
        // Fonctions pour la gestion des donn√©es
        function requestDataExport() {
            if (confirm('Voulez-vous recevoir une copie de toutes vos donn√©es par email ?')) {
                alert('Votre demande a √©t√© enregistr√©e. Vous recevrez vos donn√©es par email sous 48h.');
                // Ici, impl√©mentation de la logique backend
            }
        }

        function showDataDetails() {
            alert('Fonctionnalit√© en cours de d√©veloppement. Contactez le responsable pour plus de d√©tails.');
        }

        function requestCorrection() {
            const error = prompt('D√©crivez l\\'erreur √† corriger :');
            if (error) {
                alert('Votre demande de correction a √©t√© transmise au responsable. R√©ponse sous 5 jours ouvr√©s.');
            }
        }

        function requestPortability(format) {
            if (confirm(`Voulez-vous t√©l√©charger vos donn√©es au format ${format.toUpperCase()} ?`)) {
                alert(`Pr√©paration de vos donn√©es au format ${format.toUpperCase()}. T√©l√©chargement dans quelques instants.`);
                // Ici, logique de g√©n√©ration et t√©l√©chargement
            }
        }

        function manageConsents() {
            // R√©utilise le syst√®me de cookies
            if (typeof showCookieSettings === 'function') {
                showCookieSettings();
            } else {
                alert('Panneau de gestion des consentements en cours de chargement...');
            }
        }

        function optOutMarketing() {
            if (confirm('Voulez-vous vous d√©sinscrire de tous les emails marketing ?')) {
                alert('Vous avez √©t√© d√©sinscrit des emails marketing. Vous ne recevrez plus que les emails essentiels.');
                document.getElementById('newsletter-status').innerHTML = '‚ùå Newsletter (d√©sinscrit)';
            }
        }

        function limitProcessing() {
            if (confirm('Voulez-vous limiter le traitement de vos donn√©es au strict minimum ?')) {
                alert('Le traitement de vos donn√©es a √©t√© limit√©. Seules les fonctionnalit√©s essentielles restent actives.');
            }
        }

        function requestAccountDeactivation() {
            if (confirm('Voulez-vous d√©sactiver temporairement votre compte ? (r√©activable √† tout moment)')) {
                alert('Votre compte sera d√©sactiv√© sous 24h. Vous pourrez le r√©activer en vous reconnectant.');
            }
        }

        function requestAccountDeletion() {
            const confirmation = prompt('Pour confirmer la suppression d√©finitive, tapez "SUPPRIMER" :');
            if (confirmation === 'SUPPRIMER') {
                if (confirm('DERNI√àRE CONFIRMATION : Cette action est irr√©versible. Continuer ?')) {
                    alert('Votre demande de suppression a √©t√© enregistr√©e. Votre compte sera supprim√© sous 30 jours. Vous pouvez annuler cette demande en nous contactant.');
                }
            }
        }

        function openContactForm() {
            document.getElementById('contactModal').style.display = 'block';
        }

        function closeContactModal() {
            document.getElementById('contactModal').style.display = 'none';
        }

        // Gestion du formulaire de contact responsable
        document.getElementById('responsableContactForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Votre message a √©t√© envoy√© au responsable. R√©ponse sous 5 jours ouvr√©s.');
            closeContactModal();
            this.reset();
        });

        // Fermeture de la modal en cliquant en dehors
        window.onclick = function(event) {
            const modal = document.getElementById('contactModal');
            if (event.target == modal) {
                closeContactModal();
            }
        }
    </script>
</body>
</html>